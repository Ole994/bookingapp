import{r as u,j as e}from"./react--XRl7haj.js";import{a as S,s as E,f as D}from"./index-CuK6BhY5.js";import{c as I}from"./firebase-jztzg6lO.js";import{H as $,I as A,J as U,K as k,z as F}from"./@firebase-CJcwsLHv.js";import{c as R,a as d,b as K}from"./yup-D0TjtoPv.js";import{P as C}from"./prop-types-BiVUseAU.js";import{a as T}from"./react-router-B4NpJaNW.js";import"./react-dom-CIG6_WAD.js";import"./scheduler-CzFDRTuY.js";import"./react-router-dom-6adBjQk5.js";import"./@remix-run-D3bQaVdt.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-CMgDFqWq.js";const B=R({name:d().required("Name is required"),phone:d().matches(/^[0-9]{8,15}$/,"Phone number must be between 8 and 15 digits").required("Phone number is required"),address:d().required("Address is required"),postalCode:d().matches(/^[0-9]{4}$/,"Postal code must be exactly 4 digits").required("Postal code is required"),postalPlace:d().required("Postal place is required"),city:d().required("City is required"),email:d().email("Please enter a valid email address").required("Email is required"),password:d().min(8,"Password must be at least 8 characters long").matches(/[A-Z]/,"Password must contain at least one uppercase letter").matches(/[a-z]/,"Password must contain at least one lowercase letter").matches(/[0-9]/,"Password must contain at least one number").required("Password is required"),confirmPassword:d().oneOf([K("password"),null],"Passwords must match").required("Confirm password is required")}),N=({onCitySelect:j})=>{const[s,c]=u.useState(""),[p,i]=u.useState([]),a=async r=>{const t=r.target.value;if(c(t),t.length<3){i([]);return}try{const x=await(await fetch(`https://api.datamuse.com/sug?s=${t}&max=5`)).json();if(x){const n=x.map(v=>({city:v.word}));i(n)}else i([])}catch(m){console.error("Error fetching city suggestions:",m),i([])}},g=r=>{c(r.city),i([]),j(r.city)};return e.jsxs("div",{className:"autocomplete",children:[e.jsx("input",{type:"text",placeholder:"By",value:s,onChange:a,className:"autocomplete-input"}),p.length>0&&e.jsx("ul",{className:"autocomplete-suggestions",children:p.map((r,t)=>e.jsx("li",{onClick:()=>g(r),children:r.city},t))})]})};N.propTypes={onCitySelect:C.func.isRequired};const w=({onCountrySelect:j})=>{const[s,c]=u.useState(""),[p,i]=u.useState([]),a=async r=>{const t=r.target.value;if(c(t),t.length<1){i([]);return}try{const n=(await(await fetch(`https://restcountries.com/v3.1/name/${t}`)).json()).map(v=>({name:v.name.common}));i(n.slice(0,5))}catch(m){console.error("Error fetching country suggestions:",m),i([])}},g=r=>{c(r.name),i([]),j(r.name)};return e.jsxs("div",{className:"autocomplete",children:[e.jsx("input",{type:"text",placeholder:"Land",value:s,onChange:a,className:"autocomplete-input"}),p.length>0&&e.jsx("ul",{className:"autocomplete-suggestions",children:p.map((r,t)=>e.jsx("li",{onClick:()=>g(r),children:r.name},t))})]})};w.propTypes={onCountrySelect:C.func.isRequired};const ae=()=>{const j=T(),[s,c]=u.useState({name:"",phone:"",address:"",postalCode:"",postalPlace:"",city:"",country:"",email:"",password:"",confirmPassword:"",birthDate:"",gender:""}),[p,i]=u.useState(null),[a,g]=u.useState({}),[r,t]=u.useState(null),[m,x]=u.useState(null),n=l=>{const{name:o,value:h}=l.target;c({...s,[o]:h})},v=l=>{l.target.files[0]&&i(l.target.files[0])},P=l=>{c(o=>({...o,city:l}))},q=l=>{c(o=>({...o,country:l}))},b=async l=>{l.preventDefault(),g({}),x(null),t(null);try{await B.validate(s,{abortEarly:!1});const h=(await I(S,s.email,s.password)).user;let y="";if(p){const f=$(E,`profileImages/${h.uid}`);await A(f,p),y=await U(f)}await k(F(D,"users",h.uid),{uid:h.uid,name:s.name,email:s.email,phone:s.phone,address:s.address,postalCode:s.postalCode,postalPlace:s.postalPlace,city:s.city,country:s.country,profileImage:y,birthDate:s.birthDate,gender:s.gender}),t("User registered successfully!"),j("/profile")}catch(o){if(o.name==="ValidationError"){const h={};o.inner.forEach(y=>{h[y.path]=y.message}),g(h)}else console.error("Error signing up:",o.message),x(o.message)}};return e.jsx("div",{className:"signup-page",children:e.jsxs("div",{className:"signup-box",children:[e.jsx("h2",{children:"Opprett bruker"}),m&&e.jsx("p",{className:"message error",children:m}),r&&e.jsx("p",{className:"message success",children:r}),e.jsxs("form",{onSubmit:b,className:"signup-form",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Navn",name:"name",value:s.name,onChange:n,required:!0}),a.name&&e.jsx("div",{className:"input-error",children:a.name})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"tel",placeholder:"Telefon nummer",name:"phone",value:s.phone,onChange:n,required:!0}),a.phone&&e.jsx("div",{className:"input-error",children:a.phone})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"date",placeholder:"Fødselsdato",name:"birthDate",value:s.birthDate,onChange:n,required:!0}),a.birthDate&&e.jsx("div",{className:"input-error",children:a.birthDate})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Adresse",name:"address",value:s.address,onChange:n,required:!0}),a.address&&e.jsx("div",{className:"input-error",children:a.address})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Postnummer",name:"postalCode",value:s.postalCode,onChange:n,required:!0}),a.postalCode&&e.jsx("div",{className:"input-error",children:a.postalCode})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Postadresse",name:"postalPlace",value:s.postalPlace,onChange:n,required:!0}),a.postalPlace&&e.jsx("div",{className:"input-error",children:a.postalPlace})]}),e.jsxs("div",{className:"input-group",children:[e.jsx(N,{onCitySelect:P}),a.city&&e.jsx("div",{className:"input-error",children:a.city})]}),e.jsxs("div",{className:"input-group",children:[e.jsx(w,{onCountrySelect:q}),a.country&&e.jsx("div",{className:"input-error",children:a.country})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"email",placeholder:"E-mail",name:"email",value:s.email,onChange:n,required:!0}),a.email&&e.jsx("div",{className:"input-error",children:a.email})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"password",placeholder:"Passord",name:"password",value:s.password,onChange:n,required:!0}),a.password&&e.jsx("div",{className:"input-error",children:a.password})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"password",placeholder:"Bekreft passord",name:"confirmPassword",value:s.confirmPassword,onChange:n,required:!0}),a.confirmPassword&&e.jsx("div",{className:"input-error",children:a.confirmPassword})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"gender",children:"Kjønn:"}),e.jsxs("select",{name:"gender",value:s.gender,onChange:n,required:!0,children:[e.jsx("option",{value:"",children:"Velg Kjønn"}),e.jsx("option",{value:"Male",children:"Mann"}),e.jsx("option",{value:"Female",children:"Kvinne"}),e.jsx("option",{value:"Other",children:"Annet"})]}),a.gender&&e.jsx("div",{className:"input-error",children:a.gender})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"profileImage",className:"file-label",children:"Profile Image (optional):"}),e.jsx("input",{type:"file",id:"profileImage",accept:"image/*",onChange:v})]}),e.jsx("button",{type:"submit",className:"submit-button",children:"Sign Up"})]})]})})};export{ae as default};
