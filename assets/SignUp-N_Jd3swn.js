import{r as d,j as e}from"./react-B1wZPQ-K.js";import{a as P,f}from"./index-B3cqC5ly.js";import{c as N}from"./firebase-D2mvULzg.js";import{D as q,z as S}from"./@firebase-CvUDpUTK.js";import{c as b,a as c,b as E}from"./yup-D0TjtoPv.js";import{P as v}from"./prop-types-BiVUseAU.js";import"./react-dom-DmBrwDFL.js";import"./scheduler-CzFDRTuY.js";import"./react-router-CQggbiSl.js";import"./@remix-run-D3bQaVdt.js";import"./react-router-dom-Ds01oWgm.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-CMgDFqWq.js";const $=b({name:c().required("Name is required"),phone:c().matches(/^[0-9]{8,15}$/,"Phone number must be between 8 and 15 digits").required("Phone number is required"),address:c().required("Address is required"),postalCode:c().matches(/^[0-9]{4}$/,"Postal code must be exactly 4 digits").required("Postal code is required"),postalPlace:c().required("Postal place is required"),city:c().required("City is required"),email:c().email("Please enter a valid email address").required("Email is required"),password:c().min(8,"Password must be at least 12 characters long").matches(/[A-Z]/,"Password must contain at least one uppercase letter").matches(/[a-z]/,"Password must contain at least one lowercase letter").matches(/[0-9]/,"Password must contain at least one number").matches(/[!@#$%^&*(),.?":{}|<>]/,"Password must contain at least one special character").required("Password is required"),confirmPassword:c().oneOf([E("password"),null],"Passwords must match").required("Confirm password is required")}),C=({onCitySelect:a})=>{const[l,s]=d.useState(""),[u,o]=d.useState([]),m=async t=>{const r=t.target.value;if(s(r),r.length<3){o([]);return}try{const x=await(await fetch(`https://api.datamuse.com/sug?s=${r}&max=5`)).json();if(x){const y=x.map(n=>({city:n.word}));o(y)}else o([])}catch(p){console.error("Error fetching city suggestions:",p),o([])}},h=t=>{s(t.city),o([]),a(t.city)};return e.jsxs("div",{className:"autocomplete",children:[e.jsx("input",{type:"text",placeholder:"Enter city",value:l,onChange:m,className:"autocomplete-input"}),u.length>0&&e.jsx("ul",{className:"autocomplete-suggestions",children:u.map((t,r)=>e.jsx("li",{onClick:()=>h(t),children:t.city},r))})]})};C.propTypes={onCitySelect:v.func.isRequired};const w=({onCountrySelect:a})=>{const[l,s]=d.useState(""),[u,o]=d.useState([]),m=async t=>{const r=t.target.value;if(s(r),r.length<1){o([]);return}try{const y=(await(await fetch(`https://restcountries.com/v3.1/name/${r}`)).json()).map(n=>({name:n.name.common}));o(y.slice(0,5))}catch(p){console.error("Error fetching country suggestions:",p),o([])}},h=t=>{s(t.name),o([]),a(t.name)};return e.jsxs("div",{className:"autocomplete",children:[e.jsx("input",{type:"text",placeholder:"Enter country",value:l,onChange:m,className:"autocomplete-input"}),u.length>0&&e.jsx("ul",{className:"autocomplete-suggestions",children:u.map((t,r)=>e.jsx("li",{onClick:()=>h(t),children:t.name},r))})]})};w.propTypes={onCountrySelect:v.func.isRequired};const H=()=>{const[a,l]=d.useState({name:"",phone:"",address:"",postalCode:"",postalPlace:"",city:"",country:"",email:"",password:"",confirmPassword:""}),[s,u]=d.useState({}),[o,m]=d.useState(null),[h,t]=d.useState(null),r=n=>{const{name:i,value:g}=n.target;l({...a,[i]:g})},p=n=>{console.log("Selected city:",n),l(i=>({...i,city:n}))},x=n=>{l(i=>({...i,country:n}))},y=async n=>{n.preventDefault(),u({}),t(null),m(null),console.log("Form data before validation:",a);try{await $.validate(a,{abortEarly:!1});const g=(await N(P,a.email,a.password)).user;await q(S(f,"users"),{uid:g.uid,name:a.name,email:a.email,phone:a.phone,address:a.address,postalCode:a.postalCode,postalPlace:a.postalPlace,city:a.city,country:a.country}),m("User registered successfully!"),l({name:"",phone:"",address:"",postalCode:"",postalPlace:"",city:"",country:"",email:"",password:"",confirmPassword:""})}catch(i){if(i.name==="ValidationError"){const g={};i.inner.forEach(j=>{g[j.path]=j.message}),u(g)}else console.error("Error signing up:",i.message),t(i.message)}};return e.jsx("div",{className:"signup-page",children:e.jsxs("div",{className:"signup-box",children:[e.jsx("h2",{children:"Create Account"}),h&&e.jsx("p",{className:"message error",children:h}),o&&e.jsx("p",{className:"message success",children:o}),e.jsxs("form",{onSubmit:y,className:"signup-form",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Name",name:"name",value:a.name,onChange:r,required:!0}),s.name&&e.jsx("div",{className:"input-error",children:s.name})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"tel",placeholder:"Phone",name:"phone",value:a.phone,onChange:r,required:!0}),s.phone&&e.jsx("div",{className:"input-error",children:s.phone})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Address",name:"address",value:a.address,onChange:r,required:!0}),s.address&&e.jsx("div",{className:"input-error",children:s.address})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Postal Code",name:"postalCode",value:a.postalCode,onChange:r,required:!0}),s.postalCode&&e.jsx("div",{className:"input-error",children:s.postalCode})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",placeholder:"Postal Place",name:"postalPlace",value:a.postalPlace,onChange:r,required:!0}),s.postalPlace&&e.jsx("div",{className:"input-error",children:s.postalPlace})]}),e.jsxs("div",{className:"input-group",children:[e.jsx(C,{onCitySelect:p}),s.city&&e.jsx("div",{className:"input-error",children:s.city})]}),e.jsxs("div",{className:"input-group",children:[e.jsx(w,{onCountrySelect:x}),s.country&&e.jsx("div",{className:"input-error",children:s.country})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"email",placeholder:"Email",name:"email",value:a.email,onChange:r,required:!0}),s.email&&e.jsx("div",{className:"input-error",children:s.email})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"password",placeholder:"Password",name:"password",value:a.password,onChange:r,required:!0}),s.password&&e.jsx("div",{className:"input-error",children:s.password})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"password",placeholder:"Confirm Password",name:"confirmPassword",value:a.confirmPassword,onChange:r,required:!0}),s.confirmPassword&&e.jsx("div",{className:"input-error",children:s.confirmPassword})]}),e.jsx("button",{type:"submit",className:"submit-button",children:"Sign Up"})]})]})})};export{H as default};
